<div class="modal-backdrop" (click)="onClose()">
    <!-- Modal v3.0: Split-Screen Immersive -->
    <div class="split-modal" (click)="$event.stopPropagation()" [style.--brand-color]="project.brandColor || '#0066FF'">

        <!-- Left Column: Sticky Visual (Desktop) -->
        <div class="visual-col">
            <div class="visual-bg" *ngIf="project.image" [style.background-image]="'url(' + project.image + ')'">
                <div class="v-overlay"></div>
            </div>

            <div class="visual-content">
                <div class="top-meta">
                    <span class="category-badge">{{ project.category }}</span>
                </div>

                <h1>{{ project.title }}</h1>
                <p class="brand-pitch">{{ project.summary }}</p>

                <div class="tech-stack-visual">
                    <span *ngFor="let tag of project.tags" class="v-tag">{{ tag }}</span>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons" *ngIf="project.liveDemo || project.githubUrl">
                    <a *ngIf="project.liveDemo" [href]="project.liveDemo" target="_blank"
                        class="action-btn live-demo-btn" (click)="$event.stopPropagation()">
                        <span class="btn-icon">ðŸš€</span> Try Live Demo
                    </a>
                    <a *ngIf="project.githubUrl" [href]="project.githubUrl" target="_blank"
                        class="action-btn github-btn" (click)="$event.stopPropagation()">
                        <span class="btn-icon">ðŸ“‚</span> View on GitHub
                    </a>
                </div>

                <button class="mobile-close-btn" (click)="onClose()">&times;</button>
            </div>
        </div>

        <!-- Right Column: Scrollable Content -->
        <div class="content-col">
            <button class="desktop-close-btn" (click)="onClose()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>

            <div class="content-wrapper">

                <!-- Why It Matters Callout -->
                <section *ngIf="project.businessValue" class="section value-callout">
                    <h3>Why It Matters</h3>
                    <p class="value-text">{{ project.businessValue }}</p>
                </section>

                <!-- Intro Blurb -->
                <section class="section intro">
                    <h3>About the Project</h3>
                    <p class="full-desc">{{ project.fullDescription }}</p>
                </section>

                <!-- Live Chat Demo -->
                <section *ngIf="project.chatSimulatorData" class="section demo">
                    <h3>Solution in Action</h3>
                    <div class="iphone-mockup glass-card">
                        <div class="mockup-header">
                            <div class="notch"></div>
                            <div class="app-bar">
                                <span class="time">9:41</span>
                                <span class="status">LTE</span>
                            </div>
                            <div class="chat-meta">
                                <div class="avatar-circle">AI</div>
                                <div class="meta-text">
                                    <span class="m-name">AI Assistant</span>
                                    <span class="m-status">Active now</span>
                                </div>
                            </div>
                        </div>

                        <div class="mockup-body">
                            <ng-container *ngFor="let msg of project.chatSimulatorData">
                                <!-- User Turn -->
                                <div class="chat-row user-turn">
                                    <div class="msg-bubble user-msg">{{ msg.user }}</div>
                                </div>
                                <!-- AI Turn -->
                                <div class="chat-row ai-turn">
                                    <div class="avatar-mini">AI</div>
                                    <div class="msg-bubble ai-msg">{{ msg.ai }}</div>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                    <p class="demo-caption">Interactive prototype simulation</p>
                </section>

                <!-- Case Study: Business Context -->
                <div class="case-study-section">
                    <h3>The Business Case</h3>

                    <div class="context-grid">
                        <div class="context-item problem">
                            <h4>The Problem</h4>
                            <p>{{ project.problem }}</p>
                        </div>
                        <div class="context-item solution">
                            <h4>The Solution</h4>
                            <p>{{ project.solution }}</p>
                        </div>
                    </div>
                </div>

                <!-- Case Study: Impact -->
                <div class="case-study-section" *ngIf="project.impact">
                    <h3>Key Outcomes</h3>
                    <ul class="impact-list">
                        <li *ngFor="let item of project.impact; let i = index">
                            <span class="impact-number">{{ i + 1 }}</span>
                            <span class="impact-text">{{ item }}</span>
                        </li>
                    </ul>
                </div>

                <!-- Architecture Flow -->
                <div class="case-study-section">
                    <h3>System Architecture</h3>
                    <div class="architecture-flow">
                        <div class="flow-step" *ngFor="let step of project.architecture; let i = index">
                            <div class="step-box">{{ step }}</div>
                            <div class="step-arrow" *ngIf="i < project.architecture.length - 1">&rarr;</div>
                        </div>
                    </div>
                </div>

                <!-- Key Features -->
                <div class="case-study-section">
                    <h3>Key Features</h3>
                    <div class="features-grid">
                        <div class="feature-card" *ngFor="let feature of project.features">
                            <div class="icon">{{ feature.icon }}</div>
                            <div class="feat-content">
                                <h4>{{ feature.title }}</h4>
                                <p>{{ feature.desc }}</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div> <!-- End content-wrapper -->
        </div> <!-- End content-col -->
    </div> <!-- End split-modal -->
</div> <!-- End modal-backdrop -->